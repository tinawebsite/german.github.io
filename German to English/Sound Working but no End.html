<!DOCTYPE html>
<html style="background-color:#fffb8c">
<head>
	<title>German to English</title>
</head>
<body>
	<header>
		<button style='border-radius:25px;color:#8003fc;background-color:#d9b3ff;outline-color:#8003fc' id="home">Home</button>
	</header>
	<script>
		document.getElementById("home").addEventListener("click", function(){
			window.open("index.html", "_self")
		})
	</script>
	<h1 style="text-align:center;"><u>German to English</u></h1>
	<form style="background-color:#fcce03"> 			
		<section><input type="checkbox" id="firstCheck" > First Class</section>
		<br>
		<section><input type="checkbox" id="lastCheck"> Last Class</section>
		<br>
		<section><input type="checkbox" id="allCheck"> All Classes</section>
	</form>

	<section id="deutsche1Section" style="display:none">
		<h3><u>First Lesson</u></h3><div><i>Type in the answer as a number, not a word.</i></div>
		<br>
		<div style="display:inline">Score: </div>
		<div id='counter1' style="display:inline">0</div>
		<br>
		<br>
		<div id='germanWord1' style="display:inline;"></div><div style="display:inline;"> </div><button id="soundButton1" style="display:inline;border-radius:25px" onclick="playSound(1, deutsche1Dictionary)"> üó£Ô∏è</button>
		<br> 
		<input style='display:block;'type='text' id='myInput1' onkeydown = "if (event.keyCode == 13)document.getElementById('checkButton1').click()">
		<button id='checkButton1' style='border-radius:25px' onclick="check(1, deutsche1Dictionary)">CHECK</button>
		<button id='giveUpButton1' style='border-radius:25px' onclick="giveUp(1, deutsche1Dictionary)">GIVE UP</button>
		<button id='skipButton1' style='border-radius:25px' onclick="skip(1, deutsche1Dictionary)">SKIP</button>
		<button id='nextButton1' style='border-radius:25px' onclick="start(1, deutsche1Dictionary)">NEXT</button>
		<div id='resultsLabel1'></div>
	</section>	

	<section id="deutsche2Section" style="display:none">
		<h3><u>Last Lesson</u></h3>
		<div><i>Remember to correctly capitalise your answer.</i></div>
		<br>
		<div style="display:inline">Score: </div>
		<div id='counter2' style="display:inline">0</div>
		<br>
		<br>
		<div id='germanWord2' style="display:inline;"></div><div style="display:inline;"> </div><button id="soundButton2" style="display:inline;border-radius:25px" onclick="playSound(2, dictionaryLast)"> üó£Ô∏è</button>
		<br> 
		<input type='text' id='myInput2' onkeydown = "if (event.keyCode == 13)document.getElementById('checkButton2').click()">
		<button id='checkButton2' style='border-radius:25px'  onclick="check(2, dictionaryLast)">CHECK</button>
		<button id='giveUpButton2' style='border-radius:25px' onclick="giveUp(2, dictionaryLast)">GIVE UP</button>
		<button id='skipButton2' style='border-radius:25px' onclick="skip(2, dictionaryLast)">SKIP</button>
		<button id='nextButton2' style='border-radius:25px' onclick="start(2, dictionaryLast)">NEXT</button>
		<div id='resultsLabel2'></div>
	</section>

	<section id="deutsche3Section" style="display:none">
		<h3><u>All Lessons</u></h3>
		<div><i>Remember to correctly capitalise your answer and type numbers as numbers, not words.</i></div>
		<br>
		<div style="display:inline">Score: </div>
		<div id='counter3' style="display:inline">0</div>
		<br>
		<br>
		<div id='germanWord3' style="display:inline;"></div><div style="display:inline;"> </div><button id="soundButton3" style="display:inline;border-radius:25px" onclick="playSound(3, allFiles)"> üó£Ô∏è</button>
		<br> 
		<input type='text' id='myInput3' onkeydown = "if (event.keyCode == 13)document.getElementById('checkButton3').click()">
		<button id='checkButton3' style='border-radius:25px' onclick="check(3, allFiles)">CHECK</button>
		<button id='giveUpButton3' style='border-radius:25px' onclick="giveUp(3, allFiles)">GIVE UP</button>
		<button id='skipButton3' style='border-radius:25px' onclick="skip(3, allFiles)">SKIP</button>
		<button id='nextButton3' style='border-radius:25px' onclick="start(3, allFiles)">NEXT</button>
		<div id='resultsLabel3'></div>
	</section>

	<script>
		var numOfLessons = 0


		function Lesson(num, teacher, json, title) {
 			this.num = num
  			this.teacher = teacher  			
  			this.json = json
  			this.title = title
		}
		
		var deutsche1 = new Lesson(1, "Frau Sheikh" ,"https://api.myjson.com/bins/houcp", "Numbers 0-19") ; numOfLessons++ 
		var deutsche2 = new Lesson(2, "Frau King", "https://api.myjson.com/bins/17f894", "Greetings") ; numOfLessons++ 
		var deutsche3 = new Lesson(3, "Frau King", "https://api.myjson.com/bins/luvl5", "Numbers 20-100") ; numOfLessons++ 
		var deutsche4 = new Lesson(4, "Frau Sheikh" ,"https://api.myjson.com/bins/avjp4", "Months") ; numOfLessons++ 	
		var deutsche5 = new Lesson(5, "Frau Sheikh" ,"https://api.myjson.com/bins/18xji0", "The Verb 'Sein'") ; numOfLessons++ 		
		var deutsche6 = new Lesson(6, "Frau Sheikh" ,"https://api.myjson.com/bins/lz5wp", "Dates") ; numOfLessons++ 	
		var deutsche7 = new Lesson(7, "Frau King", "https://api.myjson.com/bins/18zons", "The Verb 'Haben'") ; numOfLessons++ 	
		var deutsche8 = new Lesson(8, "Frau Sheikh" ,"https://api.myjson.com/bins/fvsw8", "Countries") ; numOfLessons++	
		var deutsche9 = new Lesson(9, "Frau King" ,"https://api.myjson.com/bins/vibcw", "School Subjects") ; numOfLessons++	

		window.localStorage.setItem("numOfLessons",  numOfLessons)
	</script>

	
	<script>
		var deutsche1Dictionary = {} ; fetch(deutsche1.json).then(function(response){return response.json()}).then(function(myJson){Object.keys(myJson).forEach(function(key){deutsche1Dictionary[key] = myJson[key]})})

	    var deutsche2Dictionary = {} ; fetch(deutsche2.json).then(function(response){return response.json()}).then(function(myJson){Object.keys(myJson).forEach(function(key){deutsche2Dictionary[key] = myJson[key]})})	    

	    var deutsche3Dictionary = {} ; fetch(deutsche3.json).then(function(response){return response.json()}).then(function(myJson){Object.keys(myJson).forEach(function(key){deutsche3Dictionary[key] = myJson[key]})})

	   	var deutsche4Dictionary = {} ; fetch(deutsche4.json).then(function(response){return response.json()}).then(function(myJson){Object.keys(myJson).forEach(function(key){deutsche4Dictionary[key] = myJson[key]})})

	   	var deutsche5Dictionary = {} ; fetch(deutsche5.json).then(function(response){return response.json()}).then(function(myJson){Object.keys(myJson).forEach(function(key){deutsche5Dictionary[key] = myJson[key]})})

	   	var deutsche6Dictionary = {} ; fetch(deutsche6.json).then(function(response){return response.json()}).then(function(myJson){Object.keys(myJson).forEach(function(key){deutsche6Dictionary[key] = myJson[key]})})

	   	var deutsche7Dictionary = {} ; fetch(deutsche7.json).then(function(response){return response.json()}).then(function(myJson){Object.keys(myJson).forEach(function(key){deutsche7Dictionary[key] = myJson[key]})})

	   	var deutsche8Dictionary = {} ; fetch(deutsche8.json).then(function(response){return response.json()}).then(function(myJson){Object.keys(myJson).forEach(function(key){deutsche8Dictionary[key] = myJson[key]})})	   

	   	var deutsche9Dictionary = {} ; fetch(deutsche9.json).then(function(response){return response.json()}).then(function(myJson){Object.keys(myJson).forEach(function(key){deutsche9Dictionary[key] = myJson[key]})})

	   	var allFiles = {} ; fetch("https://api.myjson.com/bins/xcz1s").then(function(response){return response.json()}).then(function(myJson){Object.keys(myJson).forEach(function(key){allFiles[key] = myJson[key]})})


		var numOfLessons = window.localStorage.getItem("numOfLessons")
		var dictionaryLast = eval("deutsche" + numOfLessons + "Dictionary")
		document.getElementById("firstCheck").addEventListener( "change", function(){
			if(this.checked) {				
				start(1, deutsche1Dictionary)
			}else{
				document.getElementById("deutsche1Section").style = "display:none"
				}
		})		

		document.getElementById("lastCheck").addEventListener( "change", function(){
			if(this.checked) {				
				start(2, dictionaryLast)
			}else{
				document.getElementById("deutsche2Section").style = "display:none"
				}
		})		

		document.getElementById("allCheck").addEventListener( "change", function(){
			if(this.checked) {				
				start(3, allFiles)
			}else{
				document.getElementById("deutsche3Section").style = "display:none"
				}
		})




		var deletingDictionary1 = deutsche1Dictionary
		var deletingDictionary2 = eval("deutsche" + numOfLessons + "Dictionary") 
		var deletingDictionary3 =  allFiles
		var endCounter = 0
		var counter1 = 0
		var counter2 = 0
		var counter3 = 0

		function start(number, dictionary){
			var number = number
			var dictionary = dictionary
			var thisCounter = parseInt(document.getElementById("counter" + number).innerHTML)
			var deletingDictionary = eval("deletingDictionary" + number)
			isWrong = false
			var listOfValsUnchanged = []
			for (var key in dictionary) {
		    	if (dictionary.hasOwnProperty(key)) {
		        	listOfValsUnchanged.push([key])
		    	}
			}
			var numOfKeysUnchanged = (Object.keys(listOfValsUnchanged)).length


			document.getElementById("deutsche" + number + "Section").style = "display:inline"
			document.getElementById("myInput" + number).value = ""
			document.getElementById("resultsLabel" + number).innerHTML = ""
			document.getElementById("nextButton" + number).style.display = "none"
			document.getElementById("skipButton" + number).style.display = "inline"
			document.getElementById("checkButton" + number).style.display = "inline"
			document.getElementById("giveUpButton" + number).style.display = "inline"

			var listOfVals = []
			var myDeletingDictionary = eval("deletingDictionary" + number)
			for (var key in myDeletingDictionary) {
			    if (myDeletingDictionary.hasOwnProperty(key)) {
			        listOfVals.push([key])
			    }
			}

			var numOfKeys = (Object.keys(listOfVals)).length
			var randomNumber = Math.floor((Math.random() * numOfKeys))

			if(endCounter == numOfKeysUnchanged){
				eval("endScore" + number + "=" + thisCounter/numOfKeysUnchanged*100)
				var message = ""
				if(eval("endScore" + number) == 100){
					var message = "Perfect! You got all the questions right!"
				} else if (eval("endScore" + number)> 50){
					var message = "Well done! You got the majority of the questions correct."
				} else if (eval("endScore" + number) >= 10){
					var message = "Keep learning the words and practising them, you didn't do very well."
				}else if(eval("endScore" + number) < 30){
					var message = "Keep practising. You didn't get many questions correct."
				}

				document.getElementById("resultsLabel" + number).innerHTML = "You have finished all the words, you got " + eval("endScore" + number).toFixed(1) + "% of questions correct." + " " +  message
				document.getElementById("resultsLabel" + number).style.color = "black"
				document.getElementById("germanWord" + number).innerHTML = ""

				document.getElementById("nextButton" + number).style.display = "none"
				document.getElementById("skipButton" + number).style.display = "none"
				document.getElementById("checkButton" + number).style.display = "none"
				document.getElementById("giveUpButton" + number).style.display = "none"
				}else {					
				document.getElementById("germanWord" + number).innerHTML = dictionary[listOfVals[randomNumber]]
				var correctAns = listOfVals[randomNumber]
				window.localStorage.setItem("correctAns",  correctAns)
				delete deletingDictionary[listOfVals[randomNumber]]
			}		

			endCounter = endCounter + 1
		}
		function giveUp(number, dictionary){
			var thisCounter = parseInt(document.getElementById("counter" + number).innerHTML)
			document.getElementById("resultsLabel" + number).innerHTML = "The correct answer was: " + window.localStorage.getItem("correctAns")
			document.getElementById("resultsLabel" + number).style = "color:red"
			thisCounter = thisCounter - 3
			document.getElementById("counter" + number).innerHTML =  thisCounter
			document.getElementById("skipButton" + number).style.display = "none"
			document.getElementById("checkButton" + number).style.display = "none"
			document.getElementById("giveUpButton" + number).style.display = "none"
			document.getElementById("nextButton" + number).style.display = "inline"
			isWrong = true
			var msg = new SpeechSynthesisUtterance(document.getElementById("The correct answer was " + window.localStorage.getItem("correctAns")))
			msg.lang = "en"
			window.speechSynthesis.speak(msg)
		}
		function check(number, dictionary){
			var thisCounter = parseInt(document.getElementById("counter" + number).innerHTML)
			if(window.localStorage.getItem("correctAns") == document.getElementById("myInput" + number).value){
				document.getElementById("resultsLabel"+ number).innerHTML = "Well Done"
				document.getElementById("resultsLabel" + number).style = "color:green"
				document.getElementById("nextButton" + number).style.display = "inline"
				if(isWrong == false){
					thisCounter = thisCounter + 1
				}
				document.getElementById("counter" + number).innerHTML = thisCounter
				document.getElementById("skipButton" + number).style.display = "none"
				document.getElementById("checkButton" + number).style.display = "none"
				document.getElementById("giveUpButton" + number).style.display = "none"
				isWrong = true
				var msg = new SpeechSynthesisUtterance("Well Done!")

			}else{
				document.getElementById("resultsLabel" + number).innerHTML = "Try Again"
				document.getElementById("resultsLabel" + number).style = "color:red"
				thisCounter = thisCounter - 1
				document.getElementById("counter" + number).innerHTML = thisCounter
				isWrong = true
				var msg = new SpeechSynthesisUtterance("Try Again!")
			}
			msg.lang = "en"
			window.speechSynthesis.speak(msg)
		}
		function skip(number, dictionary){
			start(number, dictionary)
		}

	    function playSound(number) {
			var msg = new SpeechSynthesisUtterance(document.getElementById("germanWord" + number).innerHTML)
			msg.lang = "de"
			window.speechSynthesis.speak(msg)
	    }

	</script>
</body>
</html>